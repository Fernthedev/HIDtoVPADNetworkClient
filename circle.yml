machine:
  java:
    version: oraclejdk8

compile:
  override:
    - mvn package -Dci-build=true -X

general:
  artifacts:
    - "ci"

deployment:
  nightlies:
    branch: master
    commands:
      - go get github.com/tcnksm/ghr
      - export commit="$(git rev-parse --short=7 HEAD)"
      - export GIT_TAG=v0.0.1-nightly-$commit
      - ghr -t $GITHUB_TOKEN -u $CIRCLE_PROJECT_USERNAME -r $CIRCLE_PROJECT_REPONAME -prerelease -b 'Nightly release. Use caution! We recommend downloading a stable release from the README.' $GIT_TAG ci/
